---
import type { PokemonStats, PokemonDetails } from "../../types";
const { pokemonName } = Astro.params;

async function fetchData<
  TResult = "You must pass a type argument to fetchData"
>(url: string | undefined): Promise<TResult> {
  if (!url) {
    throw new Error("You must pass a URL to fetchData");
  }
  const response = await fetch(url);

  return response.json();
}

const [pokemonStats, pokemonDetails] = await Promise.all([
  fetchData<PokemonStats>(
    `https://pokeapi.co/api/v2/pokemon-species/${pokemonName}`
  ),
  fetchData<PokemonDetails>(`https://pokeapi.co/api/v2/pokemon/${pokemonName}`),
]);
console.log("ðŸš€  file: [pokemonName].astro:26  pokemonStats:", pokemonStats);
---

<main>
  <h1>{pokemonStats.name}</h1>
  <h2>Stats</h2>
  <ul>
    <img src={pokemonDetails.sprites.front_default} />
    {pokemonStats.flavor_text_entries[0].flavor_text}
  </ul>
</main>
